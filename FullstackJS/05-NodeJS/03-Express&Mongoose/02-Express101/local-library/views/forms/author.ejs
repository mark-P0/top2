<!doctype html>
<html lang="en">
  <head>
    <%- include('../components/head.ejs') -%>

    <% if (isUpdating) { -%>
    <title>Updating Author | Local Library</title>
    <% } else { -%>
    <title>New Author | Local Library</title>
    <% } -%>
  </head>
  <body class="grid md:grid-cols-[1fr_4fr] gap-6 p-6">
    <aside><%- include('../components/nav-links.ejs') -%></aside>

    <main class="grid auto-rows-min gap-6">
      <h1 class="text-5xl">
        <% if (isUpdating) { -%>
        Updating Author Entry
        <% } else { -%>
        New Author Entry
        <% } -%>
      </h1>

      <%# No way to disable button without JS, so here it is... -%>
      <script type="module">
        let form = document.querySelector("form[method=post]");
        form?.addEventListener("input", () => {
          let invalidForm = document.querySelector("form[method=post]:invalid");
          let submit = form.querySelector("button[type=submit]");
          if (submit === null) return;
          submit.disabled = invalidForm !== null;
        });
        form?.dispatchEvent(new Event("input"));
      </script>
      <form
        method="post"
        class="grid gap-3 justify-items-start [&:invalid>button[type=submit]]:opacity-50 [&:invalid>button[type=submit]]:cursor-not-allowed"
      >
        <label class="w-full grid gap-1">
          <strong>Given Name:</strong>
          <input
            type="text"
            name="givenName"
            placeholder="e.g. John"
            value="<%= defaultGivenName -%>"
            required
            min="1"
            pattern="[a-zA-Z0-9]+"
            class="border px-2 py-1"
          />
        </label>
        <label class="w-full grid gap-1">
          <strong>Family Name:</strong>
          <input
            type="text"
            name="familyName"
            placeholder="e.g. Doe"
            value="<%= defaultFamilyName -%>"
            required
            min="1"
            pattern="[a-zA-Z0-9]+"
            class="border px-2 py-1"
          />
        </label>
        <label class="w-full grid gap-1">
          <strong>Date of Birth:</strong>
          <input
            type="date"
            name="birthDate"
            value="<%= defaultBirthDate -%>"
            class="border px-2 py-1"
          />
        </label>
        <label class="w-full grid gap-1">
          <strong>Date of Death:</strong>
          <input
            type="date"
            name="deathDate"
            value="<%= defaultDeathDate -%>"
            class="border px-2 py-1"
          />
        </label>

        <%- include('../components/errors.ejs', {errors}) -%>

        <button type="submit" class="rounded bg-blue-600 text-white px-5 py-2">
          Submit
        </button>
      </form>
    </main>
  </body>
</html>
